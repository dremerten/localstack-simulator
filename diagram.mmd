flowchart LR
  user((User)) -->|HTTP 443| gw[Gateway]
  gw -->|TCP 443| sb[Sandbox ttyd]
  sb -->|AWS API| ls[LocalStack]

  subgraph Host
    gw
  end

  subgraph Sandbox_Net["Internal Network"]
    sb
    ls
    subgraph Tooling["Sandbox Tooling"]
      tf[Terraform]
      pul["Pulumi - Python"]
      ans[Ansible]
      awscli[AWS CLI]
    end
  end

  tf --> ls
  pul --> ls
  ans --> ls
  awscli --> ls

  subgraph HA_Resources["HA Reference Resources - per region"]
    vpc[VPC]
    pub["Public Subnets x3"]
    priv["Private Subnets x3"]
    igw[Internet Gateway]
    nat["NAT Gateways x3"]
    albs["ALBs x3"]
    asg["Auto Scaling Group (min 3)"]
    rds["RDS - Multi-AZ"]
    r53["Route 53 Weighted DNS"]
    s3["S3 - SSE + Block Public"]
  end

  ls --> HA_Resources

  style gw fill:#dbeafe,stroke:#1e3a8a
  style sb fill:#e0f2fe,stroke:#0c4a6e
  style ls fill:#ecfccb,stroke:#365314
